<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mein Wochenplan Offline</title>
  
  <link rel="manifest" href="data:application/manifest+json,{%22name%22:%22Wochenplan%22,%22short_name%22:%22Plan%22,%22start_url%22:%22.%22,%22display%22:%22standalone%22,%22background_color%22:%22#e0f2f7%22,%22theme_color%22:%22#4a90e2%22,%22icons%22:[{%22src%22:%22https://upload.wikimedia.org/wikipedia/commons/e/e4/Calendar_icon.svg%22,%22sizes%22:%22192x192%22,%22type%22:%22image/svg+xml%22},{%22src%22:%22https://upload.wikimedia.org/wikipedia/commons/e/e4/Calendar_icon.svg%22,%22sizes%22:%22512x512%22,%22type%22:%22image/svg+xml%22}]}">
  
  <style>
    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
      margin: 0; 
      padding: 16px; 
      color: #333; /* Dunklerer Text für besseren Kontrast */
      min-height: 100vh; /* Mindesthöhe des Bodys */
      display: flex; /* Für zentrierten Inhalt vertikal */
      flex-direction: column;
      background: linear-gradient(to bottom right, #e0f2f7, #c1e7f0); /* Sanfter Farbverlauf */
      background-size: cover; /* Bild überdeckt den ganzen Bereich */
      background-attachment: fixed; /* Hintergrund scrollt nicht mit */
    }

    /* Optional: Hintergrundbild, wenn du eines möchtest */
    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-image: url('https://source.unsplash.com/random/1920x1080/?nature,minimalist,landscape'); /* Zufälliges Bild */
      background-size: cover;
      background-position: center;
      filter: blur(5px) brightness(0.8); /* Weichzeichner und Abdunkelung */
      z-index: -1;
    }

    .max-w-4xl { max-width: 56rem; margin-left: auto; margin-right: auto; }
    .flex { display: flex; }
    .justify-between { justify-content: space-between; }
    .items-center { align-items: center; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-2 { margin-bottom: 0.5rem; }
    .grid { display: grid; gap: 1rem; grid-template-columns: 1fr; }
    @media (min-width: 640px) { .grid { grid-template-columns: repeat(2, 1fr); } }
    @media (min-width: 768px) { .grid { grid-template-columns: repeat(3, 1fr); } }
    
    .card { 
      background: rgba(255, 255, 255, 0.9); /* Leichte Transparenz für den Hintergrundeffekt */
      border-radius: 16px; /* Etwas größere Rundung */
      padding: 20px; /* Etwas mehr Polsterung */
      margin-bottom: 16px; 
      box-shadow: 0 4px 12px rgba(0,0,0,0.15); /* Deutlicherer Schatten */
      backdrop-filter: blur(8px); /* "Milchglas"-Effekt */
      border: 1px solid rgba(255, 255, 255, 0.3); /* Dezenter Rahmen */
    }
    .btn { 
      padding: 10px 20px; 
      border: none; 
      border-radius: 10px; 
      cursor: pointer; 
      font-weight: 600; 
      transition: background-color 0.2s, transform 0.1s; /* Sanfte Animation */
    }
    .btn:hover {
      transform: translateY(-1px);
    }
    .bg-blue-500 { background-color: #4a90e2; color: white; }
    .bg-blue-500:hover { background-color: #357bd8; }

    .text-red-600 { color: #e74c3c; background: none; border: none; cursor: pointer; font-size: 1.2rem; line-height: 1; padding: 4px; border-radius: 50%; }
    .text-red-600:hover { background-color: rgba(231, 76, 60, 0.1); }

    .w-full { width: 100%; }
    .p-2 { padding: 0.5rem; }
    .border { border: 1px solid #dcdcdc; }
    .rounded { border-radius: 0.5rem; }
    .block { display: block; }
    .font-bold { font-weight: 700; }

    .event-item { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      background: rgba(255, 255, 255, 0.7); /* Leichte Transparenz */
      padding: 10px 12px; 
      margin-bottom: 8px; 
      border-radius: 8px; 
      border: 1px solid rgba(220, 220, 220, 0.5); 
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
      font-size: 0.95rem;
    }

    h1 { font-size: 2rem; font-weight: bold; color: #2c3e50; } /* Dunkler für Kontrast */
    h2 { font-size: 1.4rem; font-weight: bold; color: #34495e; } /* Dunkler für Kontrast */

    label { font-weight: 600; margin-bottom: 4px; color: #555; }
    input[type="text"], input[type="time"], select {
      background-color: rgba(255, 255, 255, 0.9);
      border: 1px solid #c0d9e4;
      padding: 10px;
      border-radius: 8px;
    }
    input[type="text"]:focus, input[type="time"]:focus, select:focus {
      outline: none;
      border-color: #4a90e2;
      box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2);
    }
  </style>
</head>
<body>

<div class="max-w-4xl">
  <div class="flex justify-between items-center mb-6">
    <h1>Mein Wochenplan</h1>
    <button id="add-button" class="btn bg-blue-500">+ Termin</button>
  </div>

  <div id="add-form" class="card" style="display:none;">
    <form id="event-form">
      <label class="block mb-1">Tag</label>
      <select id="day-select" class="w-full p-2 border rounded mb-2">
        <option>Montag</option><option>Dienstag</option><option>Mittwoch</option>
        <option>Donnerstag</option><option>Freitag</option><option>Samstag</option><option>Sonntag</option>
      </select>
      <label class="block mb-1">Uhrzeit</label>
      <input type="time" id="time-input" class="w-full p-2 border rounded mb-2" required>
      <label class="block mb-1">Termin</label>
      <input type="text" id="title-input" class="w-full p-2 border rounded mb-2" placeholder="z.B. Sport" required>
      <div class="flex" style="gap: 8px;">
        <button type="submit" class="btn bg-blue-500 w-full">Speichern</button>
        <button type="button" id="cancel-button" class="btn border w-full">Abbrechen</button>
      </div>
    </form>
  </div>

  <div id="week-container" class="grid">
    <div class="card" data-day="Montag"><h2>Montag</h2><div class="events-list"></div></div>
    <div class="card" data-day="Dienstag"><h2>Dienstag</h2><div class="events-list"></div></div>
    <div class="card" data-day="Mittwoch"><h2>Mittwoch</h2><div class="events-list"></div></div>
    <div class="card" data-day="Donnerstag"><h2>Donnerstag</h2><div class="events-list"></div></div>
    <div class="card" data-day="Freitag"><h2>Freitag</h2><div class="events-list"></div></div>
    <div class="card" data-day="Samstag"><h2>Samstag</h2><div class="events-list"></div></div>
    <div class="card" data-day="Sonntag"><h2>Sonntag</h2><div class="events-list"></div></div>
  </div>
</div>

<script>
  let events = JSON.parse(localStorage.getItem('wochenplan_events') || '[]');

  function renderEvents() {
    document.querySelectorAll('.events-list').forEach(list => list.innerHTML = '');
    events.sort((a, b) => a.time.localeCompare(b.time)); // Nach Uhrzeit sortieren
    
    events.forEach(e => {
      const dayList = document.querySelector(`.card[data-day="${e.day}"] .events-list`);
      if (dayList) {
        const div = document.createElement('div');
        div.className = 'event-item';
        div.innerHTML = `<span><strong>${e.time}</strong> ${e.title}</span> <button class="delete-btn text-red-600" data-id="${e.id}" aria-label="Termin löschen">✕</button>`;
        
        div.querySelector('.delete-btn').onclick = () => {
          events = events.filter(ev => ev.id != e.id);
          localStorage.setItem('wochenplan_events', JSON.stringify(events));
          renderEvents();
        };
        dayList.appendChild(div);
      }
    });
  }

  document.getElementById('add-button').onclick = () => {
    document.getElementById('add-form').style.display = 'block';
    window.scrollTo(0,0); // Hochscrollen, falls Formular unten ist
  };

  document.getElementById('cancel-button').onclick = () => {
    document.getElementById('add-form').style.display = 'none';
    document.getElementById('event-form').reset();
  };

  document.getElementById('event-form').onsubmit = e => {
    e.preventDefault();
    const newEvent = {
      id: Date.now(),
      day: document.getElementById('day-select').value,
      time: document.getElementById('time-input').value,
      title: document.getElementById('title-input').value
    };
    events.push(newEvent);
    localStorage.setItem('wochenplan_events', JSON.stringify(events));
    document.getElementById('add-form').style.display = 'none';
    document.getElementById('event-form').reset();
    renderEvents();
  };

  // Initiales Laden der Events beim Start
  renderEvents();

  // Service Worker Registrierung (Verweist auf die separate sw.js Datei)
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js')
        .then(reg => console.log('Service Worker registriert für Offline-Nutzung:', reg))
        .catch(err => console.log('Fehler bei der Service Worker Registrierung:', err));
    });
  }
</script>
</body>
  </html>
